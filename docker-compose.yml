services:
  coordinator:
    container_name: coordinator
    build: ./services/coordinator
    depends_on:
      - graphite-statsd
    networks:
      - systems
    volumes:
      - /app/node_modules
      - ./services/coordinator/:/app:delegated
    ports:
      - '3000:3000'
    deploy:
      resources:
        limits:
          cpus: '0.50'
          memory: 50M

  docker-stats-statsd:
    build: ./tools/docker-stats-statsd
    depends_on:
      - graphite-statsd
      - coordinator
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    networks:
      - systems

  graphite-statsd:
    image: graphiteapp/graphite-statsd
    ports:
      - '1888:80'
    networks:
      - systems

  grafana:
    image: grafana/grafana
    ports:
      - '3001:3000'
    depends_on:
      - graphite-statsd
    networks:
      - systems

networks:
  systems:
